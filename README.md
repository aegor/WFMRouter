# Проект beeper WFM Router

## Предназначение

Продукт предназначен для организации маршрутизации выходных и входных http/REST-запросов
между единой WFM и несколькими базами 1с ЗУП.

### Диаграмма взаимодействия
![Диаграмма взаимодействия](doc/wfm_router_diagram.png)

## Описание процессов сборки, конфигурации, запуска и эксплуатации beeper WFM router

### Сборка проекта без IDE:

Предварительные условия:
- Перед сборкой проекта на компьютере должна быть установлена JDK 8 или старше.
- Переменная среды JAVA_HOME должна содержать путь к этой JDK, например:
```aidl
set JAVA_HOME="C:\Program Files\Java\jdk1.8.0_241"
```
В корневой парке проекта запустить команду:
```aidl
mvnw.cmd package -DskipTests
```
После сборки в папке "target" относительно корня проекта появится запускаемый файл:
```aidl
wfm.router-0.0.1-SNAPSHOT.jar
```
 ### Запуск и конфигурация WFM-маршрутизатора
 
 
[Файл конфигурации](config/application.yml) маршрутизатора снабжён подробными комментариями, поэтому его содержимое здесь не описывается.

#### Местоположение файла конфигурации относительно исполняемого файла

- По умолчанию приложение ищет файл конфигурации с названием **application.yml** в папке config относительно запускаемого приложения.
- Возможно явное указание местоположения файла конфигурации с помощью ключа 
**"--spring.config.name=conf.yml"**

#### Пример запуска приложения
```
java -jar wfm.router-0.0.1-SNAPSHOT.jar --spring.config.name=conf.yml
```  
#### TODO

Java service wrapper for windows service

### Администрирование

Если зайти браузером на URI по умолчанию, например, так: http://localhost:8080,
после ввода логина и пароля администратора, которые  в данном случае совпадают с логином и паролем
всех входных endpoints, запустится консоль администратора, на которой можно посмотреть довольно
много информации о состоянии приложения, всех URL, которые оно обслуживает, статусе этих URL и т.д.

![Административная консоль](doc/admin_console.png)

### API WFM router

API WFM router является самодокументированным на основе спецификации OpenAPI (раньше - swagger)

Доступ к браузеру API осуществляется по адресу, например:
```aidl
http://localhost:8080/swagger-ui/index.html
```
![Браузер API](doc/api_example.png)

Нажатие на кнопку "Try in out!" позволяет задавать тестовые запросы к API с разными данными.

__TODO__

В настоящий момент API документоровано лишь частично, полная мета-информация к API будет добавлена в ближайшее время.

 ### Интеграционные тесты
 Для прогона [интеграционных тестов](tests/integrationTests.http) использовался mock-сервер Mockoon и стандартные средства Intellij Idea для создания запросов.
 
 ### Нагрузочные тесты
 Для прогона нагрузочных тестов написан python-скрипт, который буде опубликован в ближайшее время в этом репозитории
 
 